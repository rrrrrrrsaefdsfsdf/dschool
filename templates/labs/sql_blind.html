{% extends "base.html" %}
{% block title %}–õ–∞–±–∞: –°–ª–µ–ø–∞—è SQL –∏–Ω—ä–µ–∫—Ü–∏—è{% endblock %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='lab-styles.css') }}">
<div class="container-fluid p-0">
    <div class="lab-main-container">
        <div class="lab-header-section">
            <div class="lab-header-icon lab-pulse">
                <i class="fas fa-user-secret"></i>
            </div>
            <h1 class="display-4">{{ lab.title if lab else "–°–ª–µ–ø–∞—è SQL –ò–Ω—ä–µ–∫—Ü–∏—è" }}</h1>
            <p class="lead text-muted">{{ lab.description if lab else "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ boolean-based —Å–ª–µ–ø—ã—Ö SQL –∏–Ω—ä–µ–∫—Ü–∏–π –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö." }}</p>
        </div>
        <div class="row">
            <div class="col-lg-7">
                {% if error %}
                    <div class="lab-error-alert">
                        <i class="fas fa-exclamation-circle me-2"></i>{{ error }}
                    </div>
                {% endif %}
                <div class="lab-check-form">
                    <h4 class="mb-4"><i class="fas fa-search me-2"></i>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ</h4>
                    <form method="POST">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <div class="mb-3">
                            <label class="form-label fw-bold">–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                            <input type="text" name="user_id" class="lab-form-control"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ–≤–æ–π ID –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏" value="{{ user_id if user_id else '' }}">
                            <small class="text-muted">–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥–∞–Ω–Ω—ã–º ID</small>
                        </div>
                        <button type="submit" class="lab-btn lab-btn-check w-100">
                            <i class="fas fa-check me-2"></i>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
                        </button>
                    </form>
                </div>
                {% if exists is not none %}
                    {% if exists %}
                        <div class="lab-result-box lab-result-success">
                            <i class="fas fa-check-circle fa-3x mb-3"></i>
                            <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ!</h4>
                            {% if username %}
                                <p class="mb-0">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <strong>{{ username }}</strong></p>
                                {% if username.startswith('FLAG{') %}
                                    <div class="lab-flag-highlight mt-2">üèÅ –§–ª–∞–≥ –Ω–∞–π–¥–µ–Ω!</div>
                                {% endif %}
                            {% endif %}
                        </div>
                    {% else %}
                        <div class="lab-result-box lab-result-fail">
                            <i class="fas fa-times-circle fa-3x mb-3"></i>
                            <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</h4>
                        </div>
                    {% endif %}
                {% endif %}
                {% if query %}
                    <div class="lab-sql-monitor">
                        <code>{{ query }}</code>
                    </div>
                {% endif %}
            </div>
            <div class="col-lg-5">
                <div class="lab-hint-section">
                    <h5 class="mb-4"><i class="fas fa-graduation-cap me-2"></i>–¢–µ—Ö–Ω–∏–∫–∏ —Å–ª–µ–ø—ã—Ö –∏–Ω—ä–µ–∫—Ü–∏–π</h5>
                    <div class="lab-hint-item">
                        <h6><i class="fas fa-eye-slash me-2 text-primary"></i>Boolean-based</h6>
                        <small>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Å–ª–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è true/false –æ—Ç–≤–µ—Ç–æ–≤</small>
                    </div>
                    <div class="lab-hint-item">
                        <h6><i class="fas fa-clock me-2 text-warning"></i>Time-based</h6>
                        <small>–ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</small>
                    </div>
                    <div class="lab-hint-item">
                        <h6><i class="fas fa-code me-2 text-success"></i>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h6>
                        <small>–§—É–Ω–∫—Ü–∏–∏ SUBSTR(), ASCII(), LENGTH() - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</small>
                    </div>
                    <div class="mt-4">
                        <h6 class="mb-3">–ü–æ–ª–µ–∑–Ω—ã–µ SQL —Ñ—É–Ω–∫—Ü–∏–∏:</h6>
                        <span class="lab-technique-badge">SUBSTR()</span>
                        <span class="lab-technique-badge">ASCII()</span>
                        <span class="lab-technique-badge">LENGTH()</span>
                        <span class="lab-technique-badge">CASE WHEN</span>
                    </div>

                    <div class="lab-info-alert mt-4">
                        <h6 class="alert-heading"><i class="fas fa-lightbulb me-2"></i>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞</h6>
                        <p class="mb-2">–ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä: <code>1 AND SUBSTR((SELECT ...), 1, 1) = 'A'</code></p>
                        <p class="mb-2">–ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞:</p>
                        <code>1 AND SUBSTR((SELECT secret FROM vulnerable_users WHERE id=1), 1, 1) = 'F'</code>
                    </div>
                    <div class="lab-table-schema mt-3">
                        <h6><i class="fas fa-database me-2"></i>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h6>
                        <pre class="mb-0"><code>vulnerable_users:
- id (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- username (–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- password (–ø–∞—Ä–æ–ª—å)
- role (—Ä–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ)
- secret (—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —Ñ–ª–∞–≥!)</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}